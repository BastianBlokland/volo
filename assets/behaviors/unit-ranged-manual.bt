{
  "$type": "AssetAiNode_Selector",
  "$name": "Root",
  "children": [
    {
      "$type": "AssetAiNode_Sequence",
      "$name": "Move to user input",
      "children": [
        {
          "$type": "AssetAiNode_Condition",
          "$name": "Wait for user input",
          "script": "$user_move_target != null;"
        },
        {
          "$type": "AssetAiNode_Execute",
          "script": "$cmd_nav_target = $user_move_target;"
        },
        {
          "$type": "AssetAiNode_Execute",
          "script": "$cmd_target_override = null;"
        },
        {
          "$type": "AssetAiNode_Try",
          "$name": "Check if we arrived at the user input",
          "child": {
            "$type": "AssetAiNode_Condition",
            "script": "$self_nav_arrived == $user_move_target;"
          }
        },
        {
          "$type": "AssetAiNode_Execute",
          "script": "$user_move_target = null;"
        }
      ]
    },
    {
      "$type": "AssetAiNode_Sequence",
      "$name": "Set attack target",
      "children": [
        {
          "$type": "AssetAiNode_Condition",
          "script": "$user_attack_target != null;"
        },
        {
          "$type": "AssetAiNode_Execute",
          "script": "$cmd_target_override = $user_attack_target;"
        },
        {
          "$type": "AssetAiNode_Execute",
          "script": "$user_attack_target = null;"
        }
      ]
    },
    {
      "$type": "AssetAiNode_Sequence",
      "$name": "Attack target",
      "children": [
        {
          "$type": "AssetAiNode_Condition",
          "$name": "Find target",
          "script": "$target_los && distance($target_position, $self_position) < 35;"
        },
        {
          "$type": "AssetAiNode_Execute",
          "$name": "Initiate attack",
          "script": "$cmd_attack_target = $target_entity; $cmd_nav_stop = true;"
        },
        {
          "$type": "AssetAiNode_Running",
          "$name": "Attacking"
        }
      ]
    },
    {
      "$type": "AssetAiNode_Sequence",
      "$name": "Move to target",
      "children": [
        {
          "$type": "AssetAiNode_Condition",
          "script": "$cmd_target_override && $target_entity == $cmd_target_override;"
        },
        {
          "$type": "AssetAiNode_Execute",
          "script": "$cmd_nav_target = $target_position;"
        },
        {
          "$type": "AssetAiNode_Try",
          "child": {
            "$type": "AssetAiNode_Condition",
            "script": "distance($target_position, $self_nav_arrived) < 5"
          }
        }
      ]
    },
    {
      "$type": "AssetAiNode_Sequence",
      "$name": "Stop if requested",
      "children": [
        {
          "$type": "AssetAiNode_Condition",
          "script": "$user_stop != null;"
        },
        {
          "$type": "AssetAiNode_Execute",
          "script": "$cmd_nav_stop = true; $user_stop = null;"
        }
      ]
    },
    {
      "$type": "AssetAiNode_Execute",
      "$name": "Idle",
      "script": "$cmd_target_override = null;"
    }
  ]
}
